<!DOCTYPE html>
<html lang="ru">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Copilot 1СО 2.0</title>
        <link
            rel="icon"
            href='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><title>SOS Icon (Red)</title><defs><style>.sos-text{font-family:-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";font-size:12px;font-weight:bold;text-anchor:middle;dominant-baseline:central;fill:%23DC2626;letter-spacing:-0.5px}.frame{fill:none;stroke:%23DC2626;stroke-width:2}</style></defs><rect x="4" y="4" width="24" height="24" rx="4" class="frame"/><text x="16" y="16" class="sos-text">SOS</text></svg>'
        />
        <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.14.0/Sortable.min.js"></script>
        <script src="https://cdn.tailwindcss.com"></script>
        <script
            src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"
            integrity="sha512-GsLlZN/3F2ErC5ifS5QtgpiJtWd43JWSuIgh7mbzZ8zBps+dvLusV+eNQATqgA/HdeKFVgA5v3S/cIrLF7QnIg=="
            crossorigin="anonymous"
            referrerpolicy="no-referrer"
        ></script>
        <script src="https://cdn.sheetjs.com/xlsx-0.20.3/package/dist/xlsx.full.min.js"></script>
        <script>
            tailwind.config = {
                darkMode: 'class',
                theme: {
                    extend: {
                        colors: {
                            primary: 'var(--color-primary, #9933FF)',
                            secondary: 'var(--color-secondary, #7B2FDF)',
                            blue: {
                                ...tailwind.colors.blue,
                                DEFAULT: 'var(--color-primary, #5D5CDE)',
                            },
                        },

                        borderRadius: {
                            none: '0px',
                            sm: 'calc(var(--border-radius, 8px) * 0.5)',
                            DEFAULT: 'var(--border-radius, 8px)',
                            md: 'calc(var(--border-radius, 8px) * 0.75)',
                            lg: 'calc(var(--border-radius, 8px) * 1.25)',
                            xl: 'calc(var(--border-radius, 8px) * 1.75)',
                            '2xl': 'calc(var(--border-radius, 8px) * 2.25)',
                            '3xl': 'calc(var(--border-radius, 8px) * 3.0)',
                            full: '9999px',
                        },

                        spacing: {
                            content: 'var(--content-spacing, 1rem)',
                            'content-sm': 'calc(var(--content-spacing, 1rem) * 0.75)',
                            'content-lg': 'calc(var(--content-spacing, 1rem) * 1.5)',
                        },

                        gap: (theme) => ({
                            ...theme('spacing'),
                        }),

                        padding: (theme) => ({
                            ...theme('spacing'),
                        }),

                        margin: (theme) => ({
                            ...theme('spacing'),
                        }),
                    },
                },
            };
        </script>
        <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
        />
        <!-- Сначала основные стили (переменные темы и база), затем скроллбар и кнопки -->
        <link rel="stylesheet" href="css/styles.css" />
        <link rel="stylesheet" href="css/inline-styles.css" />
        <!-- Оверлей загрузки: стили в head, чтобы экран был сразу с оверлеем, без белой вспышки -->
        <style id="custom-loading-overlay-styles">
            #custom-loading-overlay {
                margin: 0;
                overflow: hidden;
                height: 100vh;
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                z-index: 99999;
                background-color: #0a0a1a;
                display: flex;
                justify-content: center;
                align-items: center;
            }
            #custom-loading-overlay #loadingCanvas {
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                z-index: 1;
            }
            #custom-loading-overlay .loading-text {
                position: absolute;
                bottom: 12%;
                left: 50%;
                transform: translateX(-50%);
                max-width: 90%;
                padding: 0 20px;
                box-sizing: border-box;
                font-size: 20px;
                letter-spacing: 1px;
                line-height: 1.4;
                font-weight: 600;
                z-index: 10;
                background: linear-gradient(120deg, #8A2BE2, #4B0082, rgb(80, 0, 186), #4B0082, #8A2BE2);
                background-size: 250% 100%;
                -webkit-background-clip: text;
                background-clip: text;
                -webkit-text-fill-color: transparent;
                text-fill-color: transparent;
                animation: gradient-text-flow-smooth 4s linear infinite;
                text-align: center;
            }
            #custom-loading-overlay #animated-dots {
                display: inline-block;
                min-width: 25px;
                text-align: left;
            }
            #custom-loading-overlay #animated-dots::before {
                content: ".";
                animation: ellipsis-content-for-span 1.5s infinite steps(1, end);
            }
            #custom-loading-overlay .progress-indicator-container {
                position: absolute;
                bottom: 5%;
                left: 50%;
                transform: translateX(-50%);
                width: 280px;
                display: flex;
                flex-direction: column;
                align-items: center;
                z-index: 10;
            }
            #custom-loading-overlay .progress-bar-line-track {
                width: 100%;
                height: 6px;
                background-color: rgba(138, 43, 226, 0.15);
                border-radius: 3px;
                margin-bottom: 8px;
                overflow: hidden;
                box-shadow: inset 0 1px 2px rgba(0,0,0,0.1);
            }
            #custom-loading-overlay .progress-bar-line {
                width: 0%;
                height: 100%;
                background: linear-gradient(90deg, #8A2BE2, #A020F0, #4B0082, #A020F0, #8A2BE2);
                background-size: 300% 100%;
                border-radius: 3px;
                transition: width 0.15s linear;
                animation: progress-gradient-flow 2s linear infinite;
            }
            @keyframes progress-gradient-flow {
                0% { background-position: 0% center; }
                100% { background-position: -300% center; }
            }
            #custom-loading-overlay .progress-percentage-text {
                font-size: 14px;
                font-weight: 600;
                letter-spacing: 0.5px;
                background: linear-gradient(120deg, #9333ea, #c084fc, #9333ea);
                background-size: 200% 100%;
                -webkit-background-clip: text;
                background-clip: text;
                -webkit-text-fill-color: transparent;
                text-fill-color: transparent;
                animation: gradient-text-flow-smooth 3s linear infinite;
            }
            @keyframes gradient-text-flow-smooth {
                0% { background-position: 0% center; }
                100% { background-position: -250% center; }
            }
            @keyframes ellipsis-content-for-span {
                0% { content: "."; }
                33% { content: ".."; }
                66% { content: "..."; }
                100% { content: "."; }
            }
        </style>
    </head>

    <body
        class="bg-white dark:bg-gray-900 text-gray-800 dark:text-gray-200 transition-colors duration-200"
    >
        <!-- Оверлей загрузки первым в body — виден с первого кадра, до загрузки скриптов -->
        <div id="custom-loading-overlay">
            <canvas id="loadingCanvas"></canvas>
            <div class="loading-text" id="loadingText">Загрузка<span id="animated-dots"></span></div>
            <div class="progress-indicator-container">
                <div class="progress-bar-line-track">
                    <div class="progress-bar-line" id="progressBarLine"></div>
                </div>
                <div class="progress-percentage-text" id="progressPercentageText">0%</div>
            </div>
        </div>
        
        <!-- Ранняя анимация сферы - запускается сразу, до загрузки модулей -->
        <script>
        (function() {
            'use strict';
            const canvas = document.getElementById('loadingCanvas');
            if (!canvas) return;
            
            const ctx = canvas.getContext('2d');
            let animationFrameId = null;
            let width, height, centerX, centerY;
            let particles = [];
            let globalTime = 0;
            let rotationX = 0;
            let rotationY = 0;
            
            const easeOutCubic = (t) => 1 - Math.pow(1 - t, 3);
            
            // Палитра цветов по умолчанию с весами (долями)
            const colorPaletteWithWeights = [
                { color: [17, 24, 39, 1], weight: 42.587 },   // #111827
                { color: [31, 41, 55, 1], weight: 24.853 },   // #1F2937
                { color: [55, 65, 81, 1], weight: 18.895 },   // #374151
                { color: [147, 51, 234, 1], weight: 0.623 },  // #9333EA
                { color: [30, 40, 54, 1], weight: 0.516 },     // #1E2836
                { color: [15, 22, 36, 1], weight: 0.453 },     // #0F1624
                { color: [29, 39, 53, 1], weight: 0.439 },    // #1D2735
                { color: [15, 22, 37, 1], weight: 0.379 },     // #0F1625
                { color: [28, 38, 52, 1], weight: 0.374 },     // #1C2634
                { color: [75, 85, 99, 1], weight: 0.340 },     // #4B5563
                { color: [243, 244, 246, 1], weight: 0.309 },  // #F3F4F6
                { color: [15, 22, 35, 1], weight: 0.285 },     // #0F1623
                { color: [25, 33, 42, 1], weight: 0.276 },     // #19212A
                { color: [41, 49, 60, 1], weight: 0.273 },     // #29313C
                { color: [24, 32, 44, 1], weight: 0.271 },     // #18202C
            ];

            // Функция для взвешенного выбора цвета
            function getWeightedRandomColor() {
                const totalWeight = colorPaletteWithWeights.reduce((sum, item) => sum + item.weight, 0);
                let random = Math.random() * totalWeight;
                for (const item of colorPaletteWithWeights) {
                    random -= item.weight;
                    if (random <= 0) {
                        return item.color;
                    }
                }
                return colorPaletteWithWeights[0].color; // fallback
            }

            const config = {
                // Уменьшено количество частиц для лучшей производительности
                particleCount: 1200,
                sphereBaseRadius: 4,
                focalLength: 250,
                rotationSpeedX: 0.0003,
                rotationSpeedY: 0.002,
                breathAmplitude: 0.09,
                breathSpeed: 0.01,
                petalCount: 15,
                petalStrength: 0.2,
                baseParticleMinSize: 0.5,
                baseParticleMaxSize: 1,
                colorPalette: [
                    [140, 70, 200, 1],
                    [170, 90, 220, 0.9],
                    [110, 50, 180, 0.9],
                    [190, 100, 230, 0.95],
                    [100, 100, 230, 1],
                    [70, 70, 190, 0.95],
                    [220, 150, 240, 0.85],
                ],
                backgroundColor: 'rgba(0, 0, 0, 0)',
            };
            
            class Particle {
                constructor() {
                    const u = Math.random();
                    const v = Math.random();
                    const theta = 2 * Math.PI * u;
                    const phi = Math.acos(2 * v - 1);
                    this.baseR_factor = 0.75 + Math.random() * 0.25;
                    const petalModulation = 1 + config.petalStrength * Math.sin(phi) * Math.cos(
                        config.petalCount * theta + Math.PI / (Math.random() > 0.5 ? 2 : 1)
                    );
                    const effectiveR_factor = this.baseR_factor * petalModulation;
                    this.x0 = effectiveR_factor * Math.sin(phi) * Math.cos(theta);
                    this.y0 = effectiveR_factor * Math.sin(phi) * Math.sin(theta);
                    this.z0 = effectiveR_factor * Math.cos(phi);
                    const colorData = config.colorPalette[Math.floor(Math.random() * config.colorPalette.length)];
                    this.color_r = colorData[0];
                    this.color_g = colorData[1];
                    this.color_b = colorData[2];
                    this.baseAlphaMultiplier = colorData[3];
                    this.baseSize = config.baseParticleMinSize + Math.random() * (config.baseParticleMaxSize - config.baseParticleMinSize);
                    this.noiseAmp = 0.03 + Math.random() * 0.04;
                    this.noiseFreq = 0.005 + Math.random() * 0.01;
                    this.noisePhaseX = Math.random() * Math.PI * 2;
                    this.noisePhaseY = Math.random() * Math.PI * 2;
                    this.noisePhaseZ = Math.random() * Math.PI * 2;
                    this.screenX = 0;
                    this.screenY = 0;
                    this.projectedSize = 0;
                    this.alphaFactor = 0;
                    this.depth = 0;
                    this.currentDisplaySize = 0;
                }
                
                projectAndTransform(currentSphereRadius, breathPulse) {
                    const timeBasedNoisePhase = globalTime * this.noiseFreq;
                    const dX = Math.sin(this.noisePhaseX + timeBasedNoisePhase) * this.noiseAmp;
                    const dY = Math.cos(this.noisePhaseY + timeBasedNoisePhase) * this.noiseAmp;
                    const dZ = Math.sin(this.noisePhaseZ + timeBasedNoisePhase) * this.noiseAmp;
                    let x = this.x0 + dX;
                    let y = this.y0 + dY;
                    let z = this.z0 + dZ;
                    let tempX_rotY = x * Math.cos(rotationY) - z * Math.sin(rotationY);
                    let tempZ_rotY = x * Math.sin(rotationY) + z * Math.cos(rotationY);
                    x = tempX_rotY;
                    z = tempZ_rotY;
                    let tempY_rotX = y * Math.cos(rotationX) - z * Math.sin(rotationX);
                    let tempZ_rotX = y * Math.sin(rotationX) + z * Math.cos(rotationX);
                    y = tempY_rotX;
                    z = tempZ_rotX;
                    const dynamicSphereRadius = currentSphereRadius * (1 + breathPulse * config.breathAmplitude);
                    const perspectiveFactor = config.focalLength / (config.focalLength - z * dynamicSphereRadius * 0.8);
                    this.screenX = centerX + x * dynamicSphereRadius * perspectiveFactor;
                    this.screenY = centerY + y * dynamicSphereRadius * perspectiveFactor;
                    const normalizedDepth = z;
                    this.projectedSize = Math.max(0.1, this.baseSize * perspectiveFactor * ((normalizedDepth + 1.2) / 2.2));
                    this.alphaFactor = Math.max(0.1, Math.min(1, ((normalizedDepth + 1.5) / 2.5) * this.baseAlphaMultiplier));
                    this.depth = z;
                    this.currentDisplaySize = this.projectedSize;
                }
                
                draw() {
                    if (this.currentDisplaySize <= 0.15) return;
                    const mainAlpha = this.alphaFactor;
                    if (mainAlpha <= 0.02) return;
                    const mainSize = this.currentDisplaySize;
                    
                    // Оптимизированная отрисовка: используем простые круги с прозрачностью
                    // вместо создания градиентов для каждой частицы
                    // Это значительно быстрее, особенно при большом количестве частиц
                    
                    const haloLayers = [
                        { sizeFactor: 3.5, alphaFactor: 0.15 },
                        { sizeFactor: 2.2, alphaFactor: 0.25 },
                    ];
                    
                    // Рисуем halo слои простыми кругами с прозрачностью
                    for (const layer of haloLayers) {
                        const haloSize = mainSize * layer.sizeFactor;
                        const haloAlpha = mainAlpha * layer.alphaFactor;
                        if (haloAlpha <= 0.01 || haloSize <= 0.2) continue;
                        
                        // Используем простой круг вместо градиента для производительности
                        ctx.globalAlpha = haloAlpha * 0.3;
                        ctx.fillStyle = `rgb(${this.color_r}, ${this.color_g}, ${this.color_b})`;
                        ctx.beginPath();
                        ctx.arc(this.screenX, this.screenY, haloSize, 0, Math.PI * 2);
                        ctx.fill();
                    }
                    
                    // Рисуем ядро частицы
                    ctx.globalAlpha = mainAlpha;
                    ctx.fillStyle = `rgb(${this.color_r}, ${this.color_g}, ${this.color_b})`;
                    ctx.beginPath();
                    ctx.arc(this.screenX, this.screenY, mainSize, 0, Math.PI * 2);
                    ctx.fill();
                    
                    // Восстанавливаем глобальную прозрачность
                    ctx.globalAlpha = 1.0;
                }
            }
            
            function setupCanvas() {
                const dpr = window.devicePixelRatio || 1;
                width = window.innerWidth;
                height = window.innerHeight;
                canvas.width = width * dpr;
                canvas.height = height * dpr;
                ctx.resetTransform();
                ctx.scale(dpr, dpr);
                centerX = width / 2;
                centerY = height / 2;
                config.sphereBaseRadius = Math.min(width, height) * 0.22;
            }
            
            function init() {
                setupCanvas();
                particles = [];
                for (let i = 0; i < config.particleCount; i++) {
                    particles.push(new Particle());
                }
            }
            
            function animate() {
                globalTime++;
                rotationX += config.rotationSpeedX;
                rotationY += config.rotationSpeedY;
                
                ctx.fillStyle = config.backgroundColor;
                ctx.clearRect(0, 0, width, height);
                
                const breathPulse = Math.sin(globalTime * config.breathSpeed);
                
                // Оптимизированный цикл: вычисляем и рисуем в одном проходе
                // Используем обычный for вместо forEach для лучшей производительности
                for (let i = 0; i < particles.length; i++) {
                    const particle = particles[i];
                    particle.projectAndTransform(config.sphereBaseRadius, breathPulse);
                    particle.draw();
                }
                
                animationFrameId = requestAnimationFrame(animate);
            }
            
            function resizeHandler() {
                if (animationFrameId) {
                    cancelAnimationFrame(animationFrameId);
                    animationFrameId = null;
                }
                init();
                if (!animationFrameId) {
                    animationFrameId = requestAnimationFrame(animate);
                }
            }
            
            function start() {
                init();
                if (!animationFrameId) {
                    animationFrameId = requestAnimationFrame(animate);
                }
            }
            
            function stop() {
                if (animationFrameId) {
                    cancelAnimationFrame(animationFrameId);
                    animationFrameId = null;
                }
            }
            
            function getState() {
                return {
                    globalTime: globalTime,
                    rotationX: rotationX,
                    rotationY: rotationY
                };
            }
            
            // Запускаем анимацию сразу
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', start);
            } else {
                start();
            }
            
            window.addEventListener('resize', resizeHandler);
            
            // Сохраняем ссылку для плавного перехода к основной анимации
            window._earlySphereAnimation = {
                start: start,
                stop: stop,
                resize: resizeHandler,
                getState: getState,
                isRunning: true
            };
        })();
        </script>
        <div class="container mx-auto px-4 py-6 max-w-7xl hidden" id="appContent">
            <header class="mb-4">
                <div class="flex flex-col md:flex-row justify-between md:items-start gap-4 mb-3">
                    <div>
                        <h1 class="text-2xl md:text-3xl font-bold text-primary">Copilot 1СО</h1>
                        <p id="appSlogan" class="text-sm md:text-base text-primary">
                            Ваш надежный второй пилот
                        </p>
                    </div>
                    <div
                        class="flex flex-wrap items-center justify-center md:justify-end gap-x-3 gap-y-2 w-full md:w-auto"
                    >
                        <div class="flex items-center gap-x-2">
                            <button
                                id="showFavoritesHeaderBtn"
                                class="p-2 rounded-full text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"
                                title="Избранное"
                            >
                                <i class="fas fa-star hover:text-yellow-400"></i>
                            </button>

                            <div class="h-5 w-px bg-gray-300 dark:bg-gray-700 self-center"></div>

                            <div
                                id="appTimer"
                                class="flex items-center gap-1 text-sm flex-shrink-0"
                            >
                                <button
                                    id="timerToggleButton"
                                    title="Старт/Пауза"
                                    class="p-1.5 rounded-full text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-primary transition-colors"
                                >
                                    <i class="fas fa-play"></i>
                                </button>
                                <button
                                    id="timerResetButton"
                                    title="Сброс"
                                    class="p-1.5 rounded-full text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-primary transition-colors"
                                >
                                    <i class="fas fa-undo"></i>
                                </button>
                                <span
                                    id="timerDisplay"
                                    class="font-mono px-1 py-0.5 rounded bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-200 tabular-nums inline-flex items-baseline text-base"
                                >
                                </span>
                                <button
                                    id="timerDecreaseButton"
                                    title="Уменьшить на 1 мин"
                                    class="p-1.5 rounded-full text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-primary transition-colors"
                                >
                                    <i class="fas fa-minus"></i>
                                </button>
                                <button
                                    id="timerIncreaseButton"
                                    title="Увеличить на 1 мин"
                                    class="p-1.5 rounded-full text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-primary transition-colors"
                                >
                                    <i class="fas fa-plus"></i>
                                </button>
                            </div>
                        </div>

                        <button
                            id="themeToggle"
                            class="p-2 rounded-full text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-primary transition-colors flex-shrink-0"
                            title="Сменить тему"
                        >
                            <i class="fas fa-sun text-yellow-500 hidden dark:inline"></i>
                            <i class="fas fa-moon text-blue-300 dark:hidden"></i>
                        </button>
                        <div
                            class="relative w-full order-last sm:order-none sm:w-auto sm:min-w-[180px] md:w-[20rem] lg:w-[24rem]"
                        >
                            <input
                                type="text"
                                id="searchInput"
                                placeholder="Поиск..."
                                class="w-full pl-10 pr-10 py-2 rounded-lg bg-gray-100 dark:bg-gray-800 border border-gray-300 dark:border-gray-700 focus:outline-none focus:ring-2 focus:ring-primary text-base text-gray-900 dark:text-gray-100"
                            />
                            <i
                                class="fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"
                            ></i>
                            <button
                                id="clearSearchInputBtn"
                                type="button"
                                class="absolute top-1/2 right-3 transform -translate-y-1/2 p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hidden"
                                title="Очистить поиск"
                            >
                                <i class="fas fa-times"></i>
                            </button>
                            <div
                                id="searchResults"
                                class="absolute z-50 top-full mt-1 left-0 right-0 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-700 rounded-lg shadow-lg hidden max-h-96 overflow-y-auto"
                            ></div>
                        </div>
                        <div class="flex gap-2 flex-shrink-0">
                            <button
                                id="customizeUIBtn"
                                class="p-2 rounded-full text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-primary transition-colors"
                                title="Настройки"
                            >
                                <i class="fas fa-cog"></i>
                            </button>
                            <button
                                id="exportDataBtn"
                                class="p-2 rounded-full text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-primary transition-colors"
                                title="Экспорт базы данных"
                            >
                                <i class="fas fa-upload"></i>
                            </button>
                            <button
                                id="importDataBtn"
                                class="p-2 rounded-full text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-primary transition-colors"
                                title="Импорт базы данных"
                            >
                                <i class="fas fa-download"></i>
                            </button>
                            <button
                                id="forceReloadBtn"
                                class="p-2 rounded-full text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-primary transition-colors"
                                title="Перезагрузка приложения"
                            >
                                <i class="fas fa-sync-alt"></i>
                            </button>
                            <button
                                id="showHotkeysBtn"
                                class="p-2 rounded-full text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-primary transition-colors"
                                title="Горячие клавиши и управление Copilot"
                            >
                                <i class="fas fa-info-circle"></i>
                            </button>
                            <input type="file" id="importFileInput" accept=".json" class="hidden" />
                        </div>
                    </div>
                </div>

                <div
                    id="advancedSearchOptions"
                    class="hidden bg-gray-100 dark:bg-gray-800 p-3 rounded-lg mb-3"
                >
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
                        <div>
                            <label
                                class="block text-sm font-medium mb-1 text-gray-700 dark:text-gray-300"
                                >Искать по:</label
                            >
                            <div class="flex flex-wrap gap-2">
                                <label class="inline-flex items-center">
                                    <input
                                        type="checkbox"
                                        checked
                                        class="search-field form-checkbox text-primary focus:ring-primary"
                                        value="title"
                                    />
                                    <span class="ml-2 text-gray-700 dark:text-gray-300"
                                        >Заголовок</span
                                    >
                                </label>
                                <label class="inline-flex items-center">
                                    <input
                                        type="checkbox"
                                        checked
                                        class="search-field form-checkbox text-primary focus:ring-primary"
                                        value="description"
                                    />
                                    <span class="ml-2 text-gray-700 dark:text-gray-300"
                                        >Описание/Содержимое</span
                                    >
                                </label>
                                <label class="inline-flex items-center">
                                    <input
                                        type="checkbox"
                                        checked
                                        class="search-field form-checkbox text-primary focus:ring-primary"
                                        value="steps"
                                    />
                                    <span class="ml-2 text-gray-700 dark:text-gray-300">Шаги</span>
                                </label>
                            </div>
                        </div>
                        <div class="flex justify-end items-end md:col-start-3">
                            <button
                                id="toggleAdvancedSearch"
                                class="px-3 py-1.5 text-sm bg-primary hover:bg-secondary text-white rounded-md transition"
                            >
                                <i class="fas fa-cog mr-1"></i>Параметры поиска
                            </button>
                        </div>
                    </div>
                </div>
            </header>

            <!-- Навигация по вкладкам -->
            <div class="mb-3 border-b border-gray-200 dark:border-gray-700">
                <nav class="flex flex-wrap -mb-px text-sm font-medium text-center">
                    <button
                        id="mainTab"
                        class="tab-btn inline-block p-2.5 sm:p-3 rounded-t-lg border-b-2 border-transparent text-gray-500 dark:text-gray-400 hover:border-gray-300 dark:hover:border-gray-600 hover:text-gray-700 dark:hover:text-gray-300 whitespace-nowrap text-sm sm:text-base"
                    >
                        <i class="fas fa-home mr-1"></i>Главная
                    </button>
                    <button
                        id="programTab"
                        class="tab-btn inline-block p-2.5 sm:p-3 rounded-t-lg border-b-2 border-transparent text-gray-500 dark:text-gray-400 hover:border-gray-300 dark:hover:border-gray-600 hover:text-gray-700 dark:hover:text-gray-300 whitespace-nowrap text-sm sm:text-base"
                    >
                        <i class="fas fa-desktop mr-1"></i>Программа 1С/УП
                    </button>
                    <button
                        id="linksTab"
                        class="tab-btn inline-block p-2.5 sm:p-3 rounded-t-lg border-b-2 border-transparent text-gray-500 dark:text-gray-400 hover:border-gray-300 dark:hover:border-gray-600 hover:text-gray-700 dark:hover:text-gray-300 whitespace-nowrap text-sm sm:text-base"
                    >
                        <i class="fas fa-link mr-1"></i>Ссылки 1С
                    </button>
                    <button
                        id="extLinksTab"
                        class="tab-btn inline-block p-2.5 sm:p-3 rounded-t-lg border-b-2 border-transparent text-gray-500 dark:text-gray-400 hover:border-gray-300 dark:hover:border-gray-600 hover:text-gray-700 dark:hover:text-gray-300 whitespace-nowrap text-sm sm:text-base"
                    >
                        <i class="fas fa-globe mr-1"></i>Внешние ресурсы
                    </button>
                    <button
                        id="skziTab"
                        class="tab-btn inline-block p-2.5 sm:p-3 rounded-t-lg border-b-2 border-transparent text-gray-500 dark:text-gray-400 hover:border-gray-300 dark:hover:border-gray-600 hover:text-gray-700 dark:hover:text-gray-300 whitespace-nowrap text-sm sm:text-base"
                    >
                        <i class="fas fa-key mr-1"></i>СКЗИ
                    </button>
                    <button
                        id="lk1cTab"
                        class="tab-btn inline-block p-2.5 sm:p-3 rounded-t-lg border-b-2 border-transparent text-gray-500 dark:text-gray-400 hover:border-gray-300 dark:hover:border-gray-600 hover:text-gray-700 dark:hover:text-gray-300 whitespace-nowrap text-sm sm:text-base"
                    >
                        <i class="fas fa-user-circle mr-1"></i>1СО ЛК
                    </button>
                    <button
                        id="webRegTab"
                        class="tab-btn inline-block p-2.5 sm:p-3 rounded-t-lg border-b-2 border-transparent text-gray-500 dark:text-gray-400 hover:border-gray-300 dark:hover:border-gray-600 hover:text-gray-700 dark:hover:text-gray-300 whitespace-nowrap text-sm sm:text-base"
                    >
                        <i class="fas fa-plug mr-1"></i>Веб-Регистратор
                    </button>
                    <button
                        id="reglamentsTab"
                        class="tab-btn inline-block p-2.5 sm:p-3 rounded-t-lg border-b-2 border-transparent text-gray-500 dark:text-gray-400 hover:border-gray-300 dark:hover:border-gray-600 hover:text-gray-700 dark:hover:text-gray-300 whitespace-nowrap text-sm sm:text-base"
                    >
                        <i class="fas fa-clipboard-list mr-1"></i>Регламенты
                    </button>
                    <button
                        id="bookmarksTab"
                        class="tab-btn inline-block p-2.5 sm:p-3 rounded-t-lg border-b-2 border-transparent text-gray-500 dark:text-gray-400 hover:border-gray-300 dark:hover:border-gray-600 hover:text-gray-700 dark:hover:text-gray-300 whitespace-nowrap text-sm sm:text-base"
                    >
                        <i class="fas fa-bookmark mr-1"></i>Закладки
                    </button>
                    <button
                        id="sedoTypesTab"
                        class="tab-btn inline-block p-2.5 sm:p-3 rounded-t-lg border-b-2 border-transparent text-gray-500 dark:text-gray-400 hover:border-gray-300 dark:hover:border-gray-600 hover:text-gray-700 dark:hover:text-gray-300 whitespace-nowrap text-sm sm:text-base"
                    >
                        <i class="fas fa-comments mr-1"></i>Типы СЭДО
                    </button>
                    <button
                        id="blacklistedClientsTab"
                        class="tab-btn inline-block p-2.5 sm:p-3 rounded-t-lg border-b-2 border-transparent text-gray-500 dark:text-gray-400 hover:border-gray-300 dark:hover:border-gray-600 hover:text-gray-700 dark:hover:text-gray-300 whitespace-nowrap text-sm sm:text-base"
                    >
                        <i class="fas fa-user-secret mr-1"></i>
                        <span class="hidden sm:inline">Черный список жаб</span>
                    </button>
                    <div class="relative group ml-auto md:ml-1 shrink-0">
                        <button
                            id="moreTabsBtn"
                            class="tab-btn inline-block p-2.5 sm:p-3 rounded-t-lg border-b-2 border-transparent text-gray-500 dark:text-gray-400 hover:border-gray-300 dark:hover:border-gray-600 hover:text-gray-700 dark:hover:text-gray-300 whitespace-nowrap text-sm sm:text-base"
                        >
                            <i class="fas fa-ellipsis-h"></i>
                        </button>
                        <div
                            id="moreTabsDropdown"
                            class="absolute hidden right-0 mt-1 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-md shadow-lg z-10 w-48"
                        ></div>
                    </div>
                </nav>
            </div>

            <!-- Главная -->
            <div id="mainContent" class="tab-content">
                <div class="p-content rounded-lg shadow-md">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-content">
                        <div class="bg-gray-100 dark:bg-gray-800 p-content rounded-lg shadow-md">
                            <div
                                class="flex flex-col sm:flex-row sm:justify-between sm:items-center gap-2 mb-content-sm"
                            >
                                <h2 class="text-xl font-bold flex-shrink min-w-0">
                                    Главный алгоритм работы (значения можно редактировать под ваши
                                    нужды)
                                </h2>
                                <button
                                    id="editMainBtn"
                                    class="p-1.5 lg:px-3 lg:py-1.5 bg-primary hover:bg-secondary text-white rounded-md transition sm:self-start flex-shrink-0"
                                    title="Редактировать"
                                >
                                    <i class="fas fa-edit fa-xs lg:mr-1"></i>
                                    <span class="hidden lg:inline">Редактировать</span>
                                </button>
                            </div>
                            <div id="mainAlgorithm" class="space-y-content-sm">
                                <div
                                    class="algorithm-step bg-white dark:bg-gray-700 p-content-sm rounded-lg shadow-sm border-l-4 border-primary"
                                >
                                    <h3 class="font-bold text-base">Шаг 1: Приветствие</h3>
                                    <p class="text-sm">
                                        Поприветствуйте клиента, представьтесь, назовите компанию и
                                        спросите, чем можете помочь.
                                    </p>
                                    <p class="text-gray-600 dark:text-gray-400 mt-1 text-sm">
                                        Пример: "Добрый день! Техническая поддержка 1С-Отчетность,
                                        меня зовут [ваше имя]. Чем могу помочь?"
                                    </p>
                                </div>
                                <div
                                    class="algorithm-step bg-white dark:bg-gray-700 p-content-sm rounded-lg shadow-sm border-l-4 border-primary"
                                >
                                    <h3 class="font-bold text-base">Шаг 2: Уточнение ИНН</h3>
                                    <p class="text-sm">
                                        Запросите ИНН организации для идентификации клиента в
                                        системе.
                                    </p>
                                    <p class="text-gray-600 dark:text-gray-400 mt-1 text-sm">
                                        Пример: "Для начала работы, подскажите, пожалуйста, ИНН
                                        вашей организации."
                                    </p>
                                    <p class="text-sm text-gray-500 dark:text-gray-400 mt-1 italic">
                                        <a
                                            href="#"
                                            class="text-primary hover:underline"
                                            id="noInnLink"
                                            >Что делать, если клиент не может назвать ИНН?</a
                                        >
                                    </p>
                                </div>
                                <div
                                    class="algorithm-step bg-white dark:bg-gray-700 p-content-sm rounded-lg shadow-sm border-l-4 border-primary"
                                >
                                    <h3 class="font-bold text-base">
                                        Шаг 3: Идентификация проблемы
                                    </h3>
                                    <p class="text-sm">
                                        Выясните суть проблемы, задавая уточняющие вопросы.
                                    </p>
                                    <p class="text-gray-600 dark:text-gray-400 mt-1 text-sm">
                                        Примеры вопросов:
                                    </p>
                                    <ul
                                        class="list-disc list-inside pl-5 mt-1 text-gray-600 dark:text-gray-400 text-sm"
                                    >
                                        <li>
                                            <strong
                                                >Назовите, пожалуйста, полный текст ошибки</strong
                                            >
                                            (важно записать дословно)
                                        </li>
                                        <li>Когда впервые возникла проблема?</li>
                                    </ul>
                                </div>
                                <div
                                    class="algorithm-step bg-white dark:bg-gray-700 p-content-sm rounded-lg shadow-sm border-l-4 border-primary"
                                >
                                    <h3 class="font-bold text-base">Шаг 4: Решение проблемы</h3>
                                    <p class="text-sm">
                                        Определите категорию проблемы и перейдите к соответствующему
                                        разделу с инструкциями по решению.
                                    </p>
                                </div>
                            </div>
                        </div>

                        <div class="bg-gray-100 dark:bg-gray-800 p-content-sm rounded-lg shadow-md">
                            <div
                                class="flex flex-col sm:flex-row sm:justify-between sm:items-center gap-2 mb-content-sm"
                            >
                                <h2 class="text-lg font-bold">Информация по обращению</h2>
                                <div class="flex justify-end gap-2 p-2">
                                    <button
                                        id="clearClientDataBtn"
                                        class="p-2 lg:px-3 lg:py-1.5 bg-primary hover:bg-secondary text-white rounded-md transition text-sm flex items-center border-b"
                                        title="Очистить"
                                    >
                                        <i class="fas fa-trash"></i>
                                        <span class="hidden lg:inline lg:ml-1">Очистить</span>
                                    </button>
                                </div>
                            </div>
                            <div
                                class="bg-white dark:bg-gray-700 p-1 rounded-lg shadow-sm overflow-hidden"
                            >
                                <textarea
                                    id="clientNotes"
                                    rows="20"
                                    placeholder="Здесь для удобства можно фиксировать всю информацию по обращению клиента..."
                                    class="w-full p-1 resize-none bg-gray-50 dark:bg-gray-800 border-0 rounded-md focus:outline-none focus:ring-2 focus:ring-primary text-base text-gray-900 dark:text-gray-100 custom-scrollbar"
                                ></textarea>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Программа 1С/УП -->
            <div id="programContent" class="tab-content hidden">
                <div class="bg-gray-100 dark:bg-gray-800 p-content rounded-lg shadow-md">
                    <div
                        class="flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4 mb-content"
                    >
                        <h2 class="text-2xl font-bold">Программа 1С/УП</h2>
                        <div class="flex items-center gap-2">
                            <div
                                class="flex items-center space-x-1 border border-gray-300 dark:border-gray-600 rounded-md p-0.5"
                            >
                                <button
                                    class="view-toggle p-1.5 rounded"
                                    data-view="cards"
                                    title="Вид карточек"
                                >
                                    <i class="fas fa-th-large"></i>
                                </button>
                                <button
                                    class="view-toggle p-1.5 rounded"
                                    data-view="list"
                                    title="Вид списка"
                                >
                                    <i class="fas fa-list"></i>
                                </button>
                            </div>
                            <button
                                id="addProgramAlgorithmBtn"
                                class="px-4 py-2 bg-primary hover:bg-secondary text-white rounded-md transition"
                            >
                                <i class="fas fa-plus mr-2"></i>Добавить
                            </button>
                        </div>
                    </div>
                    <div
                        id="programAlgorithms"
                        class="grid gap-content"
                        data-section-id="programAlgorithms"
                        data-default-view="cards"
                    ></div>
                </div>
            </div>

            <!-- СКЗИ -->
            <div id="skziContent" class="tab-content hidden">
                <div class="bg-gray-100 dark:bg-gray-800 p-content rounded-lg shadow-md">
                    <div
                        class="flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4 mb-content"
                    >
                        <h2 class="text-2xl font-bold">СКЗИ</h2>
                        <div class="flex items-center gap-2">
                            <div
                                class="flex items-center space-x-1 border border-gray-300 dark:border-gray-600 rounded-md p-0.5"
                            >
                                <button
                                    class="view-toggle p-1.5 rounded"
                                    data-view="cards"
                                    title="Вид карточек"
                                >
                                    <i class="fas fa-th-large"></i>
                                </button>
                                <button
                                    class="view-toggle p-1.5 rounded"
                                    data-view="list"
                                    title="Вид списка"
                                >
                                    <i class="fas fa-list"></i>
                                </button>
                            </div>
                            <button
                                id="addSkziAlgorithmBtn"
                                class="px-4 py-2 bg-primary hover:bg-secondary text-white rounded-md transition"
                            >
                                <i class="fas fa-plus mr-2"></i>Добавить
                            </button>
                        </div>
                    </div>
                    <div
                        id="skziAlgorithms"
                        class="grid gap-content"
                        data-section-id="skziAlgorithms"
                        data-default-view="cards"
                    ></div>
                </div>
            </div>

            <!-- 1СО ЛК -->
            <div id="lk1cContent" class="tab-content hidden">
                <div class="bg-gray-100 dark:bg-gray-800 p-content rounded-lg shadow-md">
                    <div
                        class="flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4 mb-content"
                    >
                        <h2 class="text-2xl font-bold">1СО ЛК (Личный кабинет)</h2>
                        <div class="flex items-center gap-2">
                            <div
                                class="flex items-center space-x-1 border border-gray-300 dark:border-gray-600 rounded-md p-0.5"
                            >
                                <button
                                    class="view-toggle p-1.5 rounded"
                                    data-view="cards"
                                    title="Вид карточек"
                                >
                                    <i class="fas fa-th-large"></i>
                                </button>
                                <button
                                    class="view-toggle p-1.5 rounded"
                                    data-view="list"
                                    title="Вид списка"
                                >
                                    <i class="fas fa-list"></i>
                                </button>
                            </div>
                            <button
                                id="addLk1cAlgorithmBtn"
                                class="px-4 py-2 bg-primary hover:bg-secondary text-white rounded-md transition"
                            >
                                <i class="fas fa-plus mr-2"></i>Добавить
                            </button>
                        </div>
                    </div>
                    <div
                        id="lk1cAlgorithms"
                        class="grid gap-content"
                        data-section-id="lk1cAlgorithms"
                        data-default-view="cards"
                    ></div>
                </div>
            </div>

            <!-- Веб-Регистратор -->
            <div id="webRegContent" class="tab-content hidden">
                <div class="bg-gray-100 dark:bg-gray-800 p-content rounded-lg shadow-md">
                    <div
                        class="flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4 mb-content"
                    >
                        <h2 class="text-2xl font-bold">Веб-Регистратор</h2>
                        <div class="flex items-center gap-2">
                            <div
                                class="flex items-center space-x-1 border border-gray-300 dark:border-gray-600 rounded-md p-0.5"
                            >
                                <button
                                    class="view-toggle p-1.5 rounded"
                                    data-view="cards"
                                    title="Вид карточек"
                                >
                                    <i class="fas fa-th-large"></i>
                                </button>
                                <button
                                    class="view-toggle p-1.5 rounded"
                                    data-view="list"
                                    title="Вид списка"
                                >
                                    <i class="fas fa-list"></i>
                                </button>
                            </div>
                            <button
                                id="addWebRegAlgorithmBtn"
                                class="px-4 py-2 bg-primary hover:bg-secondary text-white rounded-md transition"
                            >
                                <i class="fas fa-plus mr-2"></i>Добавить
                            </button>
                        </div>
                    </div>
                    <div
                        id="webRegAlgorithms"
                        class="grid gap-content"
                        data-section-id="webRegAlgorithms"
                        data-default-view="cards"
                    ></div>
                </div>
            </div>

            <!-- Ссылки 1С -->
            <div id="linksContent" class="tab-content hidden">
                <div class="bg-gray-100 dark:bg-gray-800 p-content rounded-lg shadow-md">
                    <div
                        class="flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4 mb-content"
                    >
                        <h2 class="text-2xl font-bold">Ссылки в программе 1С</h2>
                        <div class="flex items-center gap-2">
                            <div
                                class="flex items-center space-x-1 border border-gray-300 dark:border-gray-600 rounded-md p-0.5"
                            >
                                <button
                                    class="view-toggle p-1.5 rounded"
                                    data-view="cards"
                                    title="Вид карточек"
                                >
                                    <i class="fas fa-th-large"></i>
                                </button>
                                <button
                                    class="view-toggle p-1.5 rounded"
                                    data-view="list"
                                    title="Вид списка"
                                >
                                    <i class="fas fa-list"></i>
                                </button>
                            </div>
                            <button
                                id="addLinkBtn"
                                class="px-4 py-2 bg-primary hover:bg-secondary text-white rounded-md transition"
                            >
                                <i class="fas fa-plus mr-2"></i>Добавить
                            </button>
                        </div>
                    </div>
                    <div
                        class="mb-content p-content-sm bg-blue-50 dark:bg-blue-900/50 border border-blue-200 dark:border-blue-700 rounded-lg text-sm text-blue-800 dark:text-blue-200"
                    >
                        <i class="fas fa-info-circle mr-1"></i> Это внутренние ссылки 1С (формат
                        `e1cib/...`). Используйте кнопку <i class="fas fa-copy"></i> для
                        копирования. В 1С скопированную ссылку можно вставить по комбинации клавиш
                        Shift + F11.
                    </div>
                    <div class="mb-content flex flex-col md:flex-row gap-content-sm relative">
                        <input
                            type="text"
                            id="linkSearchInput"
                            placeholder="Поиск по названию..."
                            class="flex-grow px-3 pr-10 py-2 rounded-lg bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 focus:outline-none focus:ring-2 focus:ring-primary text-base text-gray-900 dark:text-gray-100"
                        />
                        <button
                            id="clearLinkSearchInputBtn"
                            type="button"
                            class="absolute top-1/2 right-3 md:right-auto md:left-[calc(100%-2rem)] transform -translate-y-1/2 p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hidden"
                            title="Очистить поиск ссылок"
                        >
                            <i class="fas fa-times"></i>
                        </button>
                    </div>

                    <div
                        id="linksContainer"
                        class="flex flex-col"
                        data-section-id="linksContainer"
                        data-default-view="cards"
                    >
                        <div class="text-center py-6 text-gray-500 dark:text-gray-400">
                            Загрузка ссылок...
                        </div>
                    </div>
                </div>
            </div>

            <!-- Регламенты -->
            <div id="reglamentsContent" class="tab-content hidden">
                <div class="bg-gray-100 dark:bg-gray-800 p-content rounded-lg shadow-md">
                    <div
                        class="flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4 mb-content"
                    >
                        <h2 class="text-2xl font-bold">Регламенты</h2>
                        <div id="globalReglamentActionsBar" class="flex items-center space-x-2">
                            <div
                                class="flex items-center space-x-1 border border-gray-300 dark:border-gray-600 rounded-md p-0.5"
                                role="group"
                            >
                                <button
                                    type="button"
                                    class="view-toggle p-1.5 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-300"
                                    data-view="cards"
                                    title="Вид плитками"
                                >
                                    <i class="fas fa-th-large"></i>
                                </button>
                                <button
                                    type="button"
                                    class="view-toggle p-1.5 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-300"
                                    data-view="list"
                                    title="Вид списком"
                                >
                                    <i class="fas fa-list"></i>
                                </button>
                            </div>
                            <button
                                id="addReglamentBtn"
                                class="px-4 py-2 bg-primary hover:bg-secondary text-white rounded-md flex items-center justify-center whitespace-nowrap"
                            >
                                <i class="fas fa-plus mr-2"></i>Добавить регламент
                            </button>
                        </div>
                    </div>

                    <div
                        id="reglamentCategoryGrid"
                        class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-content mb-content-lg"
                        data-section-id="reglamentCategoryGrid"
                        data-default-view="cards"
                    >
                        <div class="text-center py-6 text-gray-500 md:col-span-3">
                            Загрузка категорий...
                        </div>
                    </div>

                    <div id="reglamentsList" class="hidden">
                        <div
                            class="flex flex-col sm:flex-row items-start sm:items-center justify-between mb-content gap-3"
                        >
                            <div class="flex items-center">
                                <button
                                    id="backToCategories"
                                    class="p-2 mr-2 rounded-full text-gray-500 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700 hover:text-primary transition-colors"
                                    title="Назад к категориям"
                                >
                                    <i class="fas fa-arrow-left"></i>
                                </button>
                                <h3 id="currentCategoryTitle" class="text-xl font-bold"></h3>
                            </div>
                        </div>
                        <div
                            id="reglamentsContainer"
                            class="auto-rows-fr"
                            data-section-id="reglamentsContainer"
                            data-default-view="list"
                        ></div>
                    </div>
                </div>
            </div>

            <!-- Закладки -->
            <div id="bookmarksContent" class="tab-content hidden">
                <div class="bg-gray-100 dark:bg-gray-800 p-content rounded-lg shadow-md">
                    <div class="flex flex-col sm:flex-row justify-between items-center gap-4 mb-4">
                        <h2 class="text-2xl font-bold">Закладки</h2>
                        <div class="flex items-center gap-2">
                            <div
                                class="flex items-center space-x-1 border border-gray-300 dark:border-gray-600 rounded-md p-0.5"
                                role="group"
                            >
                                <button
                                    class="view-toggle p-1.5 rounded"
                                    data-view="cards"
                                    title="Вид карточек"
                                >
                                    <i class="fas fa-th-large"></i>
                                </button>
                                <button
                                    class="view-toggle p-1.5 rounded"
                                    data-view="list"
                                    title="Вид списка"
                                >
                                    <i class="fas fa-list"></i>
                                </button>
                            </div>
                            <button
                                id="addBookmarkBtn"
                                class="px-3 py-1.5 bg-primary hover:bg-secondary text-white rounded-md transition flex items-center"
                            >
                                <i class="fas fa-plus mr-2"></i>Добавить
                            </button>
                            <button
                                id="organizeBookmarksBtn"
                                class="px-3 py-1.5 bg-primary hover:bg-secondary text-white rounded-md transition flex items-center"
                            >
                                <i class="fas fa-folder mr-2"></i>Управление папками
                            </button>
                        </div>
                    </div>

                    <div class="flex flex-col md:flex-row items-center gap-4 mb-4">
                        <div class="relative flex-grow w-full">
                            <label for="bookmarkSearchInput" class="sr-only"
                                >Поиск по закладкам</label
                            >
                            <input
                                type="text"
                                id="bookmarkSearchInput"
                                placeholder="Поиск по закладкам..."
                                class="w-full px-3 py-2 rounded-lg bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 focus:outline-none focus:ring-2 focus:ring-primary text-base text-gray-900 dark:text-gray-100"
                            />
                            <button
                                id="clearBookmarkSearchBtn"
                                type="button"
                                class="absolute top-1/2 right-3 transform -translate-y-1/2 p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hidden"
                                title="Очистить поиск по закладкам"
                            >
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        <div class="relative w-full md:w-auto">
                            <label for="bookmarkFolderFilter" class="sr-only"
                                >Фильтр по папкам</label
                            >
                            <select
                                id="bookmarkFolderFilter"
                                class="w-full md:w-auto pl-3 pr-8 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-primary text-base bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 appearance-none"
                            >
                                <option value="">Все папки</option>
                            </select>
                            <div
                                class="absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none"
                            >
                                <i class="fas fa-chevron-down text-gray-400 text-xs"></i>
                            </div>
                        </div>
                    </div>

                    <div
                        id="bookmarksContainer"
                        class="grid gap-content"
                        data-section-id="bookmarksContainer"
                        data-default-view="cards"
                    >
                        <div
                            class="col-span-full text-center py-10 text-gray-500 dark:text-gray-400"
                        >
                            Закладки не найдены.
                        </div>
                    </div>
                </div>
            </div>

            <div id="sedoTypesContent" class="tab-content hidden">
                <div class="bg-gray-100 dark:bg-gray-800 p-content rounded-lg shadow-md">
                    <div
                        class="flex flex-col sm:flex-row sm:justify-between sm:items-start gap-4 mb-content"
                    >
                        <h2 class="text-2xl font-bold text-primary">Типы сообщений СЭДО</h2>
                        <div class="flex items-center gap-2 flex-wrap sm:flex-nowrap">
                            <button
                                id="editSedoTypesBtn"
                                class="px-3 py-1.5 text-sm bg-primary hover:bg-secondary text-white rounded-md transition flex items-center"
                            >
                                <i class="fas fa-edit mr-1.5"></i>Редактировать
                            </button>
                            <button
                                id="saveSedoTypesBtn"
                                class="px-3 py-1.5 text-sm bg-green-600 hover:bg-green-700 text-white rounded-md transition flex items-center"
                                style="display: none"
                            >
                                <i class="fas fa-save mr-1.5"></i>Сохранить
                            </button>
                            <button
                                id="cancelSedoTypesBtn"
                                class="px-3 py-1.5 text-sm bg-gray-300 hover:bg-gray-400 dark:bg-gray-600 dark:hover:bg-gray-500 text-gray-700 dark:text-gray-200 rounded-md transition"
                                style="display: none"
                            >
                                Отмена
                            </button>
                        </div>
                    </div>

                    <div id="sedoTypesInfoContainer" class="space-y-content"></div>
                </div>
            </div>

            <!-- Внешние ресурсы -->
            <div id="extLinksContent" class="tab-content hidden">
                <div class="bg-gray-100 dark:bg-gray-800 p-content rounded-lg shadow-md">
                    <div
                        class="flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4 mb-content"
                    >
                        <h2 class="text-2xl font-bold">Внешние ресурсы</h2>
                        <div class="flex items-center gap-2 flex-wrap">
                            <div
                                class="flex items-center space-x-1 border border-gray-300 dark:border-gray-600 rounded-md p-0.5"
                            >
                                <button
                                    class="view-toggle p-1.5 rounded"
                                    data-view="cards"
                                    title="Вид карточек"
                                >
                                    <i class="fas fa-th-large"></i>
                                </button>
                                <button
                                    class="view-toggle p-1.5 rounded"
                                    data-view="list"
                                    title="Вид списка"
                                >
                                    <i class="fas fa-list"></i>
                                </button>
                            </div>
                            <button
                                id="addExtLinkBtn"
                                class="px-4 py-2 bg-primary hover:bg-secondary text-white rounded-md transition"
                            >
                                <i class="fas fa-plus mr-2"></i>Добавить
                            </button>
                        </div>
                    </div>
                    <div class="mb-content flex flex-col md:flex-row gap-content-sm">
                        <input
                            type="text"
                            id="extLinkSearchInput"
                            placeholder="Поиск по ресурсам..."
                            class="flex-grow px-3 py-2 rounded-lg bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 focus:outline-none focus:ring-2 focus:ring-primary text-base text-gray-900 dark:text-gray-100"
                        />
                        <select
                            id="extLinkCategoryFilter"
                            class="px-3 py-2 rounded-lg bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 focus:outline-none focus:ring-2 focus:ring-primary text-base text-gray-900 dark:text-gray-100 md:max-w-xs"
                        >
                            <option value="">Все категории</option>
                        </select>
                    </div>
                    <div
                        id="extLinksContainer"
                        class="grid gap-content"
                        data-section-id="extLinksContainer"
                        data-default-view="cards"
                    ></div>
                </div>
            </div>

            <div id="blacklistedClientsContent" class="tab-content hidden p-4">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-2xl font-semibold text-gray-800 dark:text-gray-200">
                        Черный список для жаб (но не говорите о нем <s>жабам</s> клиентам!)
                    </h2>
                    <button
                        id="addBlacklistEntryBtn"
                        class="px-4 py-2 bg-primary hover:bg-secondary text-white rounded-md shadow-sm transition"
                    >
                        <i class="fas fa-plus mr-2"></i>Добавить
                    </button>
                </div>
                <div class="mb-4 flex items-center gap-2">
                    <label for="blacklistSearchInput" class="sr-only"
                        >Поиск по черному списку</label
                    >
                    <input
                        type="text"
                        id="blacklistSearchInput"
                        placeholder="Поиск по организации, ИНН, телефону, примечанию..."
                        class="flex-grow px-3 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary text-sm"
                    />
                    <button
                        id="clearBlacklistSearchBtn"
                        title="Очистить поиск"
                        class="p-2 text-gray-500 hover:text-red-500 dark:text-gray-400 dark:hover:text-red-400 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-red-500 hidden"
                    >
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div
                    id="blacklistTableContainer"
                    class="bg-white dark:bg-gray-800 shadow rounded-lg overflow-x-auto"
                >
                    <p class="text-gray-500 dark:text-gray-400 text-center py-4">
                        Загрузка данных...
                    </p>
                </div>
            </div>

            <!-- Модальные окна -->
            <div
                id="algorithmModal"
                class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 overflow-y-auto"
            >
                <div class="flex items-center justify-center min-h-full">
                    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-7xl w-full">
                        <div class="p-content border-b border-gray-200 dark:border-gray-700">
                            <div
                                class="flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4"
                            >
                                <h2 id="modalTitle" class="text-2xl font-bold">
                                    Название алгоритма
                                </h2>
                                <div class="flex flex-wrap gap-2 justify-end flex-shrink-0">
                                    <button
                                        id="editAlgorithmBtn"
                                        class="px-4 py-2 bg-primary hover:bg-secondary text-white rounded-md transition text-sm"
                                    >
                                        <i class="fas fa-edit mr-2"></i>Редактировать
                                    </button>
                                    <button
                                        id="deleteAlgorithmBtn"
                                        class="px-4 py-2 bg-red-600 hover:bg-red-700 dark:bg-red-700 dark:hover:bg-red-800 text-white rounded-md transition text-sm"
                                    >
                                        <i class="fas fa-trash mr-2"></i>Удалить
                                    </button>
                                    <button
                                        id="toggleFullscreenViewBtn"
                                        class="p-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"
                                        title="Развернуть на весь экран"
                                    >
                                        <i class="fas fa-expand"></i>
                                    </button>
                                    <button
                                        id="closeModalBtn"
                                        class="p-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"
                                        title="Закрыть"
                                    >
                                        <i class="fas fa-times text-xl"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div
                            id="algorithmSteps"
                            class="p-content space-y-content-sm overflow-y-auto max-h-[calc(90vh-150px)]"
                        ></div>
                    </div>
                </div>
            </div>

            <!-- Модальное окно Редактирование -->
            <div
                id="editModal"
                class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 p-4 overflow-y-auto"
            >
                <div class="flex items-center justify-center min-h-full">
                    <div
                        class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-5xl w-full max-h-[95vh] flex flex-col"
                    >
                        <div class="p-content border-b border-gray-200 dark:border-gray-700">
                            <div class="flex justify-between items-center">
                                <h2 id="editModalTitle" class="text-2xl font-bold">
                                    Редактирование алгоритма
                                </h2>
                                <div class="flex items-center gap-2 justify-end flex-shrink-0">
                                    <button
                                        id="toggleFullscreenEditBtn"
                                        class="inline-block p-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors align-middle"
                                        title="Развернуть на весь экран"
                                    >
                                        <i class="fas fa-expand"></i>
                                    </button>
                                    <button
                                        id="closeEditModalBtn"
                                        class="inline-block p-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors align-middle"
                                        title="Закрыть"
                                    >
                                        <i class="fas fa-times text-xl"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="p-content overflow-y-auto flex-1 bg-gray-50 dark:bg-gray-800">
                            <div class="mb-4">
                                <label
                                    for="algorithmTitle"
                                    class="block text-sm font-medium mb-1 text-gray-700 dark:text-gray-300"
                                    >Название алгоритма</label
                                >
                                <input
                                    type="text"
                                    id="algorithmTitle"
                                    class="w-full px-3 py-2 border border-gray-300 dark:border-gray-500 rounded-md focus:outline-none focus:ring-2 focus:ring-primary text-base bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100"
                                />
                            </div>
                            <div class="mb-4" id="algorithmDescriptionContainer">
                                <label
                                    for="algorithmDescription"
                                    class="block text-sm font-medium mb-1 text-gray-700 dark:text-gray-300"
                                    >Краткое описание</label
                                >
                                <textarea
                                    id="algorithmDescription"
                                    rows="3"
                                    class="w-full px-3 py-2 border border-gray-300 dark:border-gray-500 rounded-md focus:outline-none focus:ring-2 focus:ring-primary text-base bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100"
                                ></textarea>
                            </div>
                            <h3 class="text-xl font-bold mb-3 text-gray-800 dark:text-gray-200">
                                Шаги
                            </h3>
                            <div id="editSteps" class="space-y-4"></div>
                            <div class="mt-4">
                                <button
                                    id="addStepBtn"
                                    class="px-4 py-2 bg-primary hover:bg-secondary text-white rounded-md transition"
                                >
                                    <i class="fas fa-plus mr-2"></i>Добавить шаг
                                </button>
                            </div>
                        </div>
                        <div
                            class="p-content border-t border-gray-200 dark:border-gray-600 mt-auto"
                        >
                            <div class="flex justify-end items-center gap-2">
                                <button
                                    id="cancelEditBtn"
                                    class="px-4 py-2 bg-gray-200 hover:bg-gray-300 dark:bg-gray-600 dark:hover:bg-gray-500 text-gray-700 dark:text-gray-200 rounded-md transition"
                                >
                                    Отмена
                                </button>
                                <button
                                    id="saveAlgorithmBtn"
                                    class="px-4 py-2 bg-primary hover:bg-secondary text-white rounded-md transition"
                                >
                                    <i class="fas fa-save mr-1"></i> Сохранить изменения
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div
                id="addModal"
                class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 p-4 overflow-y-auto"
            >
                <div class="flex items-center justify-center min-h-full">
                    <div
                        class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] flex flex-col"
                    >
                        <div class="p-content border-b border-gray-200 dark:border-gray-700">
                            <div class="flex justify-between items-center">
                                <h2 id="addModalTitle" class="text-2xl font-bold">
                                    Новый алгоритм
                                </h2>
                                <div>
                                    <button
                                        id="toggleFullscreenAddBtn"
                                        class="inline-block p-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors align-middle"
                                        title="Развернуть на весь экран"
                                    >
                                        <i class="fas fa-expand"></i>
                                    </button>
                                    <button
                                        id="closeAddModalBtn"
                                        class="inline-block p-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors align-middle"
                                        title="Закрыть"
                                    >
                                        <i class="fas fa-times text-xl"></i>
                                    </button>
                                </div>
                            </div>
                        </div>

                        <div class="p-content overflow-y-auto flex-1 bg-gray-100 dark:bg-gray-700">
                            <div class="mb-4">
                                <label
                                    for="newAlgorithmTitle"
                                    class="block text-sm font-medium mb-1 text-gray-700 dark:text-gray-300"
                                    >Название алгоритма</label
                                >
                                <input
                                    type="text"
                                    id="newAlgorithmTitle"
                                    class="w-full px-3 py-2 border border-gray-300 dark:border-gray-500 rounded-md focus:outline-none focus:ring-2 focus:ring-primary text-base bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100"
                                />
                            </div>
                            <div class="mb-4">
                                <label
                                    for="newAlgorithmDesc"
                                    class="block text-sm font-medium mb-1 text-gray-700 dark:text-gray-300"
                                    >Краткое описание</label
                                >
                                <textarea
                                    id="newAlgorithmDesc"
                                    rows="3"
                                    class="w-full px-3 py-2 border border-gray-300 dark:border-gray-500 rounded-md focus:outline-none focus:ring-2 focus:ring-primary text-base bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100"
                                ></textarea>
                            </div>

                            <div id="newSteps" class="space-y-4"></div>

                            <div class="mt-4">
                                <button
                                    id="addNewStepBtn"
                                    class="px-4 py-2 bg-primary hover:bg-secondary text-white rounded-md transition"
                                >
                                    <i class="fas fa-plus mr-2"></i>Добавить шаг
                                </button>
                            </div>
                        </div>

                        <div
                            class="p-content border-t border-gray-200 dark:border-gray-600 mt-auto"
                        >
                            <div class="flex justify-end gap-2">
                                <button
                                    id="cancelAddBtn"
                                    class="px-4 py-2 bg-gray-200 hover:bg-gray-300 dark:bg-gray-600 dark:hover:bg-gray-500 text-gray-700 dark:text-gray-200 rounded-md transition"
                                >
                                    Отмена
                                </button>
                                <button
                                    id="saveNewAlgorithmBtn"
                                    class="px-4 py-2 bg-primary hover:bg-secondary text-white rounded-md transition"
                                >
                                    Сохранить
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Модальное окно Настройки UI -->
            <div
                id="customizeUIModal"
                class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 p-4 overflow-y-auto flex items-center justify-center hidden"
            >
                <div class="flex items-center justify-center min-h-full">
                    <div
                        class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-7xl w-full max-h-screen flex flex-col modal-inner-container overflow-hidden"
                    >
                        <div class="p-content border-b border-gray-200 dark:border-gray-700">
                            <div class="flex justify-between items-center gap-4">
                                <h2 class="text-2xl font-bold">Настройки</h2>
                                <div class="flex items-center gap-3">
                                    <div class="relative">
                                        <span
                                            id="employeeExtensionDisplay"
                                            class="inline-block px-4 py-2 text-base border-2 border-gray-300 dark:border-gray-600 rounded-lg cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors min-w-[180px] text-center align-middle"
                                            title="Клик для редактирования"
                                        >
                                        </span>
                                        <input
                                            type="text"
                                            id="employeeExtensionInput"
                                            class="inline-block px-4 py-2 text-base border-2 border-primary rounded-lg focus:outline-none focus:ring-2 focus:ring-primary bg-white dark:bg-gray-900 hidden min-w-[180px] align-middle"
                                            maxlength="4"
                                            pattern="\d*"
                                            title="Введите доб. номер"
                                        />
                                    </div>
                                    <button
                                        id="closeCustomizeUIModalBtn"
                                        class="p-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"
                                        title="Закрыть"
                                    >
                                        <i class="fas fa-times text-xl"></i>
                                    </button>
                                </div>
                            </div>
                        </div>

                        <div class="p-content overflow-y-auto flex-1">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-content-lg">
                                <div>
                                    <div class="mb-content">
                                        <label
                                            class="block text-sm font-medium mb-1 text-gray-700 dark:text-gray-300"
                                            >Ориентация главного экрана</label
                                        >
                                        <div class="flex space-x-3 mt-2">
                                            <label class="flex items-center">
                                                <input
                                                    type="radio"
                                                    name="mainLayout"
                                                    value="horizontal"
                                                    class="form-radio text-primary focus:ring-primary mr-2"
                                                    checked
                                                />
                                                <span class="text-gray-700 dark:text-gray-300"
                                                    >Горизонтальная</span
                                                >
                                            </label>
                                            <label class="flex items-center">
                                                <input
                                                    type="radio"
                                                    name="mainLayout"
                                                    value="vertical"
                                                    class="form-radio text-primary focus:ring-primary mr-2"
                                                />
                                                <span class="text-gray-700 dark:text-gray-300"
                                                    >Вертикальная</span
                                                >
                                            </label>
                                        </div>
                                    </div>
                                    <div class="mb-content">
                                        <label
                                            class="block text-sm font-medium mb-1 text-gray-700 dark:text-gray-300"
                                            >Управление разделами (вкладками)</label
                                        >
                                        <div class="space-y-2 mt-2">
                                            <div id="panelSortContainer" class="space-y-2"></div>
                                            <p
                                                class="text-xs text-gray-500 dark:text-gray-400 mt-2"
                                            >
                                                * Перетаскивайте элементы для изменения порядка
                                                вкладок
                                            </p>
                                        </div>
                                    </div>
                                </div>

                                <div>
                                    <h3
                                        class="text-lg font-semibold mb-content-sm text-gray-900 dark:text-gray-100"
                                    >
                                        Настройка цветов элементов (БЕТА)
                                    </h3>
                                    <div
                                        class="flex justify-between flex-wrap space-x-4"
                                        id="colorTargetSelector"
                                    >
                                        <label class="flex items-center cursor-pointer">
                                            <input
                                                type="radio"
                                                name="colorTarget"
                                                value="elements"
                                                class="form-radio text-primary focus:ring-primary"
                                                checked
                                            />
                                            <span
                                                class="ml-2 text-gray-700 dark:text-gray-300 font-medium"
                                                >ЦВЕТ ЭЛЕМЕНТОВ</span
                                            >
                                        </label>
                                        <label class="flex items-center cursor-pointer">
                                            <input
                                                type="radio"
                                                name="colorTarget"
                                                value="background"
                                                class="form-radio text-primary focus:ring-primary"
                                            />
                                            <span
                                                class="ml-2 text-gray-700 dark:text-gray-300 font-medium"
                                                >ЦВЕТ ФОНА</span
                                            >
                                        </label>
                                        <label class="flex items-center cursor-pointer">
                                            <input
                                                type="radio"
                                                name="colorTarget"
                                                value="text"
                                                class="form-radio text-primary focus:ring-primary"
                                            />
                                            <span
                                                class="ml-2 text-gray-700 dark:text-gray-300 font-medium"
                                                >ЦВЕТ ТЕКСТА</span
                                            >
                                        </label>
                                    </div>
                                    <div class="mb-content" id="advancedColorPicker">
                                        <div class="flex items-center justify-center mt-2 mb-4">
                                            <div
                                                id="color-preview-swatch"
                                                class="w-20 h-20 rounded-lg border-4 border-white dark:border-gray-700 shadow-inner"
                                            ></div>
                                        </div>

                                        <div class="space-y-3 mt-4">
                                            <div>
                                                <div
                                                    class="flex items-center justify-between text-sm text-gray-600 dark:text-gray-400 mb-1"
                                                >
                                                    <label for="hue-value">Цвет</label>
                                                    <input
                                                        id="hue-value"
                                                        type="text"
                                                        readonly
                                                        class="w-16 text-center bg-gray-100 dark:bg-gray-900/50 border border-gray-300 dark:border-gray-600 rounded text-sm py-0.5"
                                                    />
                                                </div>
                                                <div
                                                    id="hue-slider"
                                                    class="relative w-full h-4 rounded-full cursor-pointer p-0.5 bg-gray-200 dark:bg-gray-700"
                                                >
                                                    <div
                                                        class="w-full h-full rounded-full overflow-hidden"
                                                    >
                                                        <div
                                                            id="hue-slider-gradient"
                                                            class="w-full h-full"
                                                        ></div>
                                                    </div>
                                                    <div
                                                        id="hue-handle"
                                                        class="absolute w-5 h-5 -mt-2.5 top-1/2 rounded-full border-2 border-white shadow-md bg-transparent pointer-events-none"
                                                        style="left: 0%"
                                                    ></div>
                                                </div>
                                            </div>
                                            <div>
                                                <div
                                                    class="flex items-center justify-between text-sm text-gray-600 dark:text-gray-400 mb-1"
                                                >
                                                    <label for="saturation-value"
                                                        >Насыщенность</label
                                                    >
                                                    <input
                                                        id="saturation-value"
                                                        type="text"
                                                        readonly
                                                        class="w-16 text-center bg-gray-100 dark:bg-gray-900/50 border border-gray-300 dark:border-gray-600 rounded text-sm py-0.5"
                                                    />
                                                </div>
                                                <div
                                                    id="saturation-slider"
                                                    class="relative w-full h-4 rounded-full cursor-pointer p-0.5 bg-gray-200 dark:bg-gray-700"
                                                >
                                                    <div
                                                        class="w-full h-full rounded-full overflow-hidden"
                                                    >
                                                        <div
                                                            id="saturation-slider-gradient"
                                                            class="w-full h-full"
                                                        ></div>
                                                    </div>
                                                    <div
                                                        id="saturation-handle"
                                                        class="absolute w-5 h-5 -mt-2.5 top-1/2 rounded-full border-2 border-white shadow-md pointer-events-none"
                                                        style="left: 80%"
                                                    ></div>
                                                </div>
                                            </div>
                                            <div>
                                                <div
                                                    class="flex items-center justify-between text-sm text-gray-600 dark:text-gray-400 mb-1"
                                                >
                                                    <label for="brightness-value">Яркость</label>
                                                    <input
                                                        id="brightness-value"
                                                        type="text"
                                                        readonly
                                                        class="w-16 text-center bg-gray-100 dark:bg-gray-900/50 border border-gray-300 dark:border-gray-600 rounded text-sm py-0.5"
                                                    />
                                                </div>
                                                <div
                                                    id="brightness-slider"
                                                    class="relative w-full h-4 rounded-full cursor-pointer p-0.5 bg-gray-200 dark:bg-gray-700"
                                                >
                                                    <div
                                                        class="w-full h-full rounded-full overflow-hidden"
                                                    >
                                                        <div
                                                            id="brightness-slider-gradient"
                                                            class="w-full h-full"
                                                        ></div>
                                                    </div>
                                                    <div
                                                        id="brightness-handle"
                                                        class="absolute w-5 h-5 -mt-2.5 top-1/2 rounded-full border-2 border-white shadow-md pointer-events-none"
                                                        style="left: 88%"
                                                    ></div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="mb-content">
                                        <label
                                            class="block text-sm font-medium mb-1 text-gray-700 dark:text-gray-300"
                                            >Режим темы</label
                                        >
                                        <div class="flex space-x-3 mt-2">
                                            <label class="flex items-center">
                                                <input
                                                    type="radio"
                                                    name="themeMode"
                                                    value="light"
                                                    class="form-radio text-primary focus:ring-primary mr-2"
                                                />
                                                <span class="text-gray-700 dark:text-gray-300"
                                                    >Светлая</span
                                                >
                                            </label>
                                            <label class="flex items-center">
                                                <input
                                                    type="radio"
                                                    name="themeMode"
                                                    value="dark"
                                                    class="form-radio text-primary focus:ring-primary mr-2"
                                                />
                                                <span class="text-gray-700 dark:text-gray-300"
                                                    >Темная</span
                                                >
                                            </label>
                                        </div>
                                    </div>
                                    <div class="mb-content">
                                        <label
                                            class="block text-sm font-medium mb-1 text-gray-700 dark:text-gray-300"
                                            >Масштаб</label
                                        >
                                        <div class="flex items-center space-x-3 mt-2">
                                            <button
                                                id="decreaseFontBtn"
                                                class="p-1.5 rounded border border-gray-300 dark:border-gray-600 focus:outline-none text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"
                                            >
                                                <i class="fas fa-minus"></i>
                                            </button>
                                            <span
                                                id="fontSizeLabel"
                                                class="text-gray-700 dark:text-gray-300"
                                                >100%</span
                                            >
                                            <button
                                                id="increaseFontBtn"
                                                class="p-1.5 rounded border border-gray-300 dark:border-gray-600 focus:outline-none text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"
                                            >
                                                <i class="fas fa-plus"></i>
                                            </button>
                                            <button
                                                id="resetFontBtn"
                                                class="ml-2 text-xs text-primary hover:underline focus:outline-none focus:ring-2 focus:ring-primary rounded"
                                            >
                                                Сбросить на 100%
                                            </button>
                                        </div>
                                    </div>
                                    <div class="mb-content">
                                        <label
                                            class="block text-sm font-medium mb-1 text-gray-700 dark:text-gray-300"
                                            >Скругление углов</label
                                        >
                                        <input
                                            type="range"
                                            min="0"
                                            max="20"
                                            value="8"
                                            class="w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-lg appearance-none cursor-pointer accent-primary"
                                            id="borderRadiusSlider"
                                        />
                                        <div
                                            class="flex justify-between text-xs text-gray-500 dark:text-gray-400 mt-1"
                                        >
                                            <span>Квадратные</span>
                                            <span>Скругленные</span>
                                        </div>
                                    </div>
                                    <div class="mb-content">
                                        <label
                                            class="block text-sm font-medium mb-1 text-gray-700 dark:text-gray-300"
                                            >Настройка отступов</label
                                        >
                                        <input
                                            type="range"
                                            min="0"
                                            max="6"
                                            value="3"
                                            class="w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-lg appearance-none cursor-pointer accent-primary"
                                            id="densitySlider"
                                        />
                                        <div
                                            class="flex justify-between text-xs text-gray-500 dark:text-gray-400 mt-1"
                                        >
                                            <span>Меньше</span>
                                            <span>Больше</span>
                                        </div>
                                    </div>
                                    <div class="mb-content">
                                        <label
                                            class="block text-sm font-medium mb-1 text-gray-700 dark:text-gray-300"
                                            >Фоновое изображение</label
                                        >
                                        <div class="flex items-center gap-4 mt-2">
                                            <div
                                                id="backgroundImagePreview"
                                                class="rounded-md bg-gray-200 dark:bg-gray-700/50 border border-gray-300 dark:border-gray-600 flex-shrink-0 flex items-center justify-center"
                                            >
                                                <span
                                                    id="backgroundImagePreviewText"
                                                    class="text-xs text-gray-500 dark:text-gray-400 p-2 text-center"
                                                    >Нет изображения</span
                                                >
                                            </div>
                                            <div class="flex flex-col gap-2">
                                                <button
                                                    type="button"
                                                    id="backgroundImageUploadBtn"
                                                    class="px-3 py-1.5 text-sm bg-primary hover:bg-secondary text-white rounded-md transition"
                                                >
                                                    <i class="fas fa-upload mr-2"></i>Загрузить...
                                                </button>
                                                <button
                                                    type="button"
                                                    id="backgroundImageRemoveBtn"
                                                    class="px-3 py-1.5 text-sm bg-red-600 hover:bg-red-700 text-white rounded-md transition hidden"
                                                >
                                                    <i class="fas fa-trash mr-2"></i>Удалить
                                                </button>
                                                <input
                                                    type="file"
                                                    id="backgroundImageInput"
                                                    class="hidden"
                                                    accept="image/png, image/jpeg, image/gif, image/webp"
                                                />
                                            </div>
                                        </div>
                                    </div>
                                    <div
                                        class="space-y-content-sm border-t border-gray-200 dark:border-gray-600 pt-content-sm mt-content-lg px-content-sm pb-content-sm rounded-b-lg"
                                        id="additionalSecuritySettingsSection"
                                    >
                                        <div>
                                            <label
                                                for="toggleBlacklistWarning"
                                                class="flex items-center cursor-pointer"
                                            >
                                                <input
                                                    type="checkbox"
                                                    id="toggleBlacklistWarning"
                                                    name="showBlacklistUsageWarning"
                                                    class="form-checkbox h-5 w-5 text-primary focus:ring-primary border-gray-300 dark:border-gray-600 rounded"
                                                />
                                                <span
                                                    class="ml-3 text-sm text-gray-700 dark:text-gray-300"
                                                    >Всегда показывать предупреждение при входе в
                                                    раздел ЧС</span
                                                >
                                            </label>
                                            <p
                                                class="text-xs text-gray-500 dark:text-gray-400 mt-1 pl-8"
                                            >
                                                Если эта опция отключена, вы не будете видеть
                                                страницу с предупреждением каждый раз при переходе в
                                                раздел "Черный список".
                                            </p>
                                        </div>

                                        <div
                                            class="pt-content-sm border-t border-gray-200 dark:border-gray-600"
                                            id="uiImportSettingsSection"
                                        >
                                            <label
                                                for="toggleDisableForcedBackup"
                                                class="flex items-center cursor-pointer"
                                            >
                                                <input
                                                    type="checkbox"
                                                    id="toggleDisableForcedBackup"
                                                    name="disableForcedBackupOnImport"
                                                    class="form-checkbox h-5 w-5 text-primary focus:ring-primary border-gray-300 dark:border-gray-600 rounded"
                                                />
                                                <span
                                                    class="ml-3 text-sm text-gray-700 dark:text-gray-300"
                                                    >Отключить принудительный бэкап при импорте
                                                    базы</span
                                                >
                                            </label>
                                            <p
                                                class="text-xs text-gray-500 dark:text-gray-400 mt-1 pl-8"
                                            >
                                                Если эта опция включена, приложение не будет
                                                автоматически создавать резервную копию текущей базы
                                                данных перед импортом новой. Используйте с
                                                осторожностью.
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div
                            class="p-content border-t border-gray-200 dark:border-gray-700 mt-auto bg-gray-50 dark:bg-gray-700 -mx-6 -mb-6 rounded-b-lg"
                        >
                            <div class="flex justify-between gap-2 flex-wrap">
                                <button
                                    id="clearAllDataBtn"
                                    class="btn-destructive btn-destructive-all"
                                >
                                    <i class="fas fa-skull-crossbones mr-2"></i>Очистить все данные
                                </button>
                                <button
                                    id="resetUiBtn"
                                    class="btn-secondary btn-destructive border-b p-2"
                                >
                                    Сбросить настройки интерфейса
                                </button>
                                <div class="flex gap-2">
                                    <button
                                        id="cancelUISettingsBtn"
                                        class="px-4 py-2 bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-200 rounded-md transition"
                                    >
                                        Отмена
                                    </button>
                                    <button
                                        id="saveUISettingsBtn"
                                        class="px-4 py-2 bg-primary hover:bg-secondary text-white rounded-md transition"
                                    >
                                        Сохранить
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Модальное окно подтверждения очистки данных -->
            <div
                id="confirmClearDataModal"
                class="fixed inset-0 bg-black bg-opacity-50 hidden z-[60] p-4 overflow-y-auto"
            >
                <div class="flex items-center justify-center min-h-full">
                    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-lg w-full">
                        <div class="p-content border-b border-gray-200 dark:border-gray-700">
                            <div class="flex justify-between items-center">
                                <h2 class="text-xl font-bold text-red-600 dark:text-red-500">
                                    <i class="fas fa-exclamation-triangle mr-2"></i>Подтвердите
                                    очистку данных
                                </h2>
                                <button
                                    class="close-confirm-clear-modal p-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"
                                    title="Закрыть"
                                >
                                    <i class="fas fa-times text-xl"></i>
                                </button>
                            </div>
                        </div>
                        <div class="p-content space-y-4">
                            <p class="text-base text-gray-700 dark:text-gray-300 text-lg">
                                Вы уверены, что хотите
                                <strong class="text-red-600 dark:text-red-500"
                                    >полностью удалить все данные</strong
                                >
                                приложения (алгоритмы, настройки, заметки, закладки, ссылки,
                                регламенты - всё, что вы вносили)?
                            </p>
                            <p class="text-lg font-semibold text-red-600 dark:text-red-500">
                                Это действие необратимо!
                            </p>
                            <div
                                id="clearDataWarningBox"
                                class="bg-yellow-50 dark:bg-yellow-900/50 border border-yellow-200 dark:border-yellow-700 rounded-lg p-3 text-lg text-yellow-800 dark:text-yellow-200"
                            >
                                <i class="fas fa-info-circle mr-1"></i> Рекомендуется
                                <button
                                    id="exportBeforeClearBtn"
                                    class="font-medium underline hover:text-yellow-900 dark:hover:text-yellow-100 focus:outline-none"
                                >
                                    сначала экспортировать ваши данные
                                </button>
                                в файл на случай, если они понадобятся в будущем.
                            </div>
                            <p class="text-sm text-gray-600 dark:text-gray-400">
                                После очистки приложение будет перезагружено со стандартными
                                настройками и данными. Повторная индексация базы данных после
                                очистки может занимать некоторое время.
                            </p>
                        </div>
                        <div
                            class="p-content border-t border-gray-200 dark:border-gray-700 mt-auto bg-gray-50 dark:bg-gray-700 rounded-b-lg"
                        >
                            <div class="flex justify-end gap-3">
                                <button
                                    id="cancelClearDataBtn"
                                    class="px-4 py-2 bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-200 rounded-md transition border"
                                >
                                    Отмена
                                </button>
                                <button
                                    id="confirmAndClearDataBtn"
                                    class="px-4 py-2 text-white rounded-md transition border"
                                >
                                    <i class="fas fa-trash mr-1"></i> Да, очистить все данные
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Модальное окно Ссылки 1С -->
            <div
                id="cibLinkModal"
                class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 p-4 overflow-y-auto"
            >
                <div class="flex items-center justify-center min-h-full">
                    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-lg w-full">
                        <div class="p-content border-b border-gray-200 dark:border-gray-700">
                            <div class="flex justify-between items-center">
                                <h2 id="cibLinkModalTitle" class="text-xl font-bold">
                                    Добавить ссылку 1С
                                </h2>
                                <button
                                    class="close-modal p-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"
                                    title="Закрыть"
                                >
                                    <i class="fas fa-times text-xl"></i>
                                </button>
                            </div>
                        </div>
                        <form id="cibLinkForm">
                            <div class="p-content space-y-4">
                                <input type="hidden" id="cibLinkId" />
                                <div>
                                    <label
                                        class="block text-sm font-medium mb-1 text-gray-700 dark:text-gray-300"
                                        for="cibLinkTitle"
                                        >Название (для отображения)</label
                                    >
                                    <input
                                        type="text"
                                        id="cibLinkTitle"
                                        required
                                        class="w-full px-3 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-primary text-base text-gray-900 dark:text-gray-100"
                                    />
                                </div>
                                <div>
                                    <label
                                        class="block text-sm font-medium mb-1 text-gray-700 dark:text-gray-300"
                                        for="cibLinkValue"
                                        >Ссылка 1С (e1cib/...)</label
                                    >
                                    <input
                                        type="text"
                                        id="cibLinkValue"
                                        required
                                        placeholder="e1cib/list/РегистрСведений.ЧтоТоТам"
                                        class="w-full px-3 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-primary text-base text-gray-900 dark:text-gray-100"
                                    />
                                </div>
                                <div>
                                    <label
                                        class="block text-sm font-medium mb-1 text-gray-700 dark:text-gray-300"
                                        for="cibLinkDescription"
                                        >Описание (опционально)</label
                                    >
                                    <textarea
                                        id="cibLinkDescription"
                                        rows="3"
                                        class="w-full px-3 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-primary text-base text-gray-900 dark:text-gray-100"
                                    ></textarea>
                                </div>
                            </div>
                            <div
                                class="p-content border-t border-gray-200 dark:border-gray-700 mt-auto"
                            >
                                <div class="flex justify-end gap-2">
                                    <button
                                        type="button"
                                        class="cancel-modal px-4 py-2 bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-200 rounded-md transition"
                                    >
                                        Отмена
                                    </button>
                                    <button
                                        type="submit"
                                        id="saveCibLinkBtn"
                                        class="px-4 py-2 bg-primary hover:bg-secondary text-white rounded-md transition"
                                    >
                                        <i class="fas fa-save mr-1"></i> Сохранить
                                    </button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <div id="favoritesContent" class="tab-content hidden">
                <div class="bg-gray-100 dark:bg-gray-800 p-content rounded-lg shadow-md">
                    <div
                        class="flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4 mb-content"
                    >
                        <h2 class="text-2xl font-bold">Избранное</h2>
                        <div class="flex items-center gap-2">
                            <div
                                class="flex items-center space-x-1 border border-gray-300 dark:border-gray-600 rounded-md p-0.5"
                                role="group"
                            >
                                <button
                                    class="view-toggle p-1.5 rounded"
                                    data-view="cards"
                                    title="Вид плитками"
                                >
                                    <i class="fas fa-th-large"></i>
                                </button>
                                <button
                                    class="view-toggle p-1.5 rounded"
                                    data-view="list"
                                    title="Вид списком"
                                >
                                    <i class="fas fa-list"></i>
                                </button>
                            </div>
                            <button
                                id="clearFavoritesBtn"
                                class="px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-md transition text-sm"
                                title="Очистить все избранное"
                            >
                                <i class="fas fa-trash-alt mr-1"></i> Очистить всё
                            </button>
                        </div>
                    </div>
                    <div
                        id="favoritesContainer"
                        class="grid gap-content auto-rows-fr"
                        data-section-id="favoritesContainer"
                        data-default-view="cards"
                    >
                        <p class="text-center py-6 text-gray-500 dark:text-gray-400 col-span-full">
                            В избранном пока ничего нет.
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Модальное окно Горячие клавиши -->
        <div
            id="hotkeysModal"
            class="fixed inset-0 bg-black bg-opacity-60 hidden z-[80] p-4 overflow-y-auto"
        >
            <div class="flex items-center justify-center min-h-full">
                <div
                    class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] flex flex-col"
                >
                    <div class="p-5 border-b border-gray-200 dark:border-gray-700 flex-shrink-0">
                        <div class="flex justify-between items-center">
                            <h2
                                class="text-xl font-bold text-gray-900 dark:text-gray-100 flex items-center"
                            >
                                <i class="fas fa-keyboard mr-3 text-primary"></i>Горячие клавиши и
                                управление
                            </h2>
                            <div class="flex items-center flex-shrink-0">
                                <button
                                    id="toggleFullscreenHotkeysBtn"
                                    type="button"
                                    class="p-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"
                                    title="Развернуть на весь экран"
                                >
                                    <i class="fas fa-expand"></i>
                                </button>
                                <button
                                    id="closeHotkeysModalBtn"
                                    type="button"
                                    class="p-2 ml-1 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"
                                    title="Закрыть (Esc)"
                                >
                                    <i class="fas fa-times text-xl"></i>
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="p-6 overflow-y-auto flex-1 text-sm leading-relaxed">
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-x-8 gap-y-6">
                            <div class="space-y-6">
                                <section>
                                    <h3
                                        class="text-lg font-semibold mb-3 border-b border-gray-300 dark:border-gray-600 pb-1.5 flex items-center"
                                    >
                                        <i
                                            class="fas fa-compass w-6 text-center text-primary mr-2"
                                        ></i
                                        >Навигация по приложению
                                    </h3>
                                    <ul class="space-y-3 list-inside">
                                        <li>
                                            <code class="hotkey-code">Alt + H</code> — Перейти в
                                            раздел Главная.
                                        </li>
                                        <li>
                                            <code class="hotkey-code">Alt + L</code> — Перейти в
                                            раздел Избранное.
                                        </li>
                                        <li>
                                            <code class="hotkey-code">Alt + F</code> — Установить
                                            фокус на поле глобального поиска.
                                        </li>
                                        <li>
                                            <code class="hotkey-code">Backspace</code> (вне полей
                                            ввода) — Вернуться на предыдущий экран (например, из
                                            списка регламентов к категориям).
                                        </li>
                                    </ul>
                                </section>

                                <section>
                                    <h3
                                        class="text-lg font-semibold mb-3 border-b border-gray-300 dark:border-gray-600 pb-1.5 flex items-center"
                                    >
                                        <i
                                            class="fas fa-database w-6 text-center text-primary mr-2"
                                        ></i
                                        >Работа с данными
                                    </h3>
                                    <ul class="space-y-3 list-inside">
                                        <li>
                                            <code class="hotkey-code">Alt + S</code> — Сохранить
                                            изменения в активном окне создания/редактирования.
                                        </li>
                                        <li>
                                            <code class="hotkey-code">Alt + N</code> — Открыть окно
                                            добавления нового элемента для текущей активной секции
                                            (алгоритма, закладки и т.д.).
                                        </li>
                                        <li>
                                            <code class="hotkey-code">Alt + Shift + S</code> —
                                            Экспортировать (сохранить) всю базу данных в файл.
                                        </li>
                                        <li>
                                            <code class="hotkey-code">Alt + Shift + O</code> —
                                            Открыть диалог импорта (открытия) базы данных из файла.
                                        </li>
                                        <li>
                                            <code class="hotkey-code"
                                                >Ctr + ЛКМ (внутри поля ввода данных по
                                                клиенту)</code
                                            >
                                            Позволяет по единичному нажатию комбинации сразу и
                                            удобно копировать ИНН клиента в буфер обмена (при
                                            наличии фокуса в поле ввода).
                                        </li>
                                    </ul>
                                </section>
                            </div>

                            <div class="space-y-6">
                                <section>
                                    <h3
                                        class="text-lg font-semibold mb-3 border-b border-gray-300 dark:border-gray-600 pb-1.5 flex items-center"
                                    >
                                        <i
                                            class="fas fa-window-maximize w-6 text-center text-primary mr-2"
                                        ></i
                                        >Окна и интерфейс
                                    </h3>
                                    <ul class="space-y-3 list-inside">
                                        <li>
                                            <code class="hotkey-code">Alt + I</code> — Открыть окно
                                            настроек приложения.
                                        </li>
                                        <li>
                                            <code class="hotkey-code">Alt + T</code> — Переключить
                                            тему (Авто / Светлая / Темная).
                                        </li>
                                        <li>
                                            <code class="hotkey-code">Alt + V</code> — Переключить
                                            вид отображения элементов (список/плитки) в текущей
                                            секции.
                                        </li>
                                        <li>
                                            <code class="hotkey-code">Alt + R</code> —
                                            Принудительная перезагрузка приложения.
                                        </li>
                                        <li>
                                            <code class="hotkey-code">Ctrl + Shift + H</code> —
                                            Открыть/закрыть это окно помощи.
                                        </li>
                                        <li>
                                            <code class="hotkey-code">Esc</code> — Закрыть самое
                                            верхнее активное окно. В полях поиска — очищает ввод.
                                        </li>
                                    </ul>
                                </section>

                                <section>
                                    <h3
                                        class="text-lg font-semibold mb-3 border-b border-gray-300 dark:border-gray-600 pb-1.5 flex items-center"
                                    >
                                        <i
                                            class="fas fa-tasks w-6 text-center text-primary mr-2"
                                        ></i
                                        >Контекстные действия
                                    </h3>
                                    <ul class="space-y-3 list-inside">
                                        <li>
                                            <b>Избранное:</b>
                                            <ul class="list-disc list-inside pl-5 mt-1 space-y-1">
                                                <li>
                                                    <code class="hotkey-code">Alt + K</code> —
                                                    Добавить/удалить текущий открытый элемент в
                                                    Избранное (в окне просмотра деталей).
                                                </li>
                                            </ul>
                                        </li>
                                        <li>
                                            <b>Поле "Информация по обращению":</b>
                                            <ul class="list-disc list-inside pl-5 mt-1 space-y-1">
                                                <li>
                                                    <code class="hotkey-code">Ctrl + Enter</code> —
                                                    Вставить следующий пункт нумерованного списка.
                                                </li>
                                                <li>
                                                    <code class="hotkey-code"
                                                        >Ctrl + Shift + Backspace</code
                                                    >
                                                    — Очистить поле (с подтверждением).
                                                </li>
                                                <li>
                                                    <code class="hotkey-code">Alt + = / Alt -</code>
                                                    — Увеличить/уменьшить размер текста в окне
                                                    данных по обращению на Главной.
                                                </li>
                                            </ul>
                                        </li>
                                        <li>
                                            <b>Таймер:</b>
                                            <ul class="list-disc list-inside pl-5 mt-1 space-y-1">
                                                <li>
                                                    Нажатие
                                                    <i class="fas fa-play w-4 text-center"></i> /
                                                    <i class="fas fa-pause w-4 text-center"></i>:
                                                    Старт/Пауза.
                                                </li>
                                                <li>
                                                    Нажатие
                                                    <i class="fas fa-undo w-4 text-center"></i>:
                                                    Сброс на стандартное время.
                                                </li>
                                                <li>
                                                    <code class="hotkey-code">Ctrl</code> + Нажатие
                                                    <i class="fas fa-undo w-4 text-center"></i>:
                                                    Сброс на 00:00.
                                                </li>
                                                <li>
                                                    Нажатие
                                                    <i class="fas fa-plus w-4 text-center"></i>:
                                                    Увеличить время.
                                                </li>
                                                <li>
                                                    Нажатие
                                                    <i class="fas fa-minus w-4 text-center"></i>:
                                                    Уменьшить время.
                                                </li>
                                            </ul>
                                        </li>
                                        <li>
                                            <b>Просмотр изображений (Лайтбокс):</b>
                                            <ul class="list-disc list-inside pl-5 mt-1 space-y-1">
                                                <li>
                                                    <code class="hotkey-code"
                                                        ><i
                                                            class="fas fa-arrow-left w-3 text-center"
                                                        ></i
                                                    ></code>
                                                    /
                                                    <code class="hotkey-code"
                                                        ><i
                                                            class="fas fa-arrow-right w-3 text-center"
                                                        ></i
                                                    ></code>
                                                    — Предыдущее / следующее изображение.
                                                </li>
                                                <li>
                                                    <code class="hotkey-code">Колесо мыши</code> —
                                                    Масштабирование изображения.
                                                </li>
                                                <li>
                                                    <code class="hotkey-code">Перетаскивание</code>
                                                    — Перемещение увеличенного изображения.
                                                </li>
                                            </ul>
                                        </li>
                                    </ul>
                                </section>
                            </div>
                        </div>
                    </div>

                    <div
                        class="p-4 border-t border-gray-200 dark:border-gray-700 mt-auto flex-shrink-0 text-right"
                    >
                        <button
                            type="button"
                            id="okHotkeysModalBtn"
                            class="px-5 py-2 bg-primary hover:bg-secondary text-white rounded-md transition"
                        >
                            OK
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div
            id="screenshotLightbox"
            tabindex="-1"
            class="fixed inset-0 bg-black bg-opacity-80 hidden z-[90] p-4 flex items-center justify-center backdrop-blur-sm overflow-hidden"
        >
            <div class="relative w-full h-full flex items-center justify-center">
                <img
                    id="lightboxImage"
                    src=""
                    alt="Просмотр скриншота"
                    class="max-w-[95%] max-h-[95%] object-contain hidden cursor-grab active:cursor-grabbing"
                    style="transition: transform 0.1s ease-out; transform-origin: center center"
                />

                <div
                    id="lightboxCounter"
                    class="absolute bottom-4 left-1/2 transform -translate-x-1/2 text-white text-sm bg-black bg-opacity-50 px-2 py-1 rounded z-20"
                >
                    1 / 1
                </div>
                <button
                    id="closeLightboxBtn"
                    class="absolute top-4 right-4 text-white text-3xl opacity-80 hover:opacity-100 transition-opacity focus:outline-none focus:shadow-none z-20"
                    title="Закрыть (Esc)"
                >
                    ×
                </button>
                <button
                    id="prevLightboxBtn"
                    class="absolute left-4 top-1/2 transform -translate-y-1/2 text-white text-3xl opacity-50 hover:opacity-100 transition-opacity focus:outline-none p-2 bg-black bg-opacity-30 rounded-full z-20 disabled:opacity-20 disabled:cursor-not-allowed"
                    title="Предыдущее (←)"
                >
                    ‹
                </button>
                <button
                    id="nextLightboxBtn"
                    class="absolute right-4 top-1/2 transform -translate-y-1/2 text-white text-3xl opacity-50 hover:opacity-100 transition-opacity focus:outline-none p-2 bg-black bg-opacity-30 rounded-full z-20 disabled:opacity-20 disabled:cursor-not-allowed"
                    title="Следующее (→)"
                >
                    ›
                </button>
            </div>
        </div>

        <div id="app-copyright" class="p-3 text-center text-2xs">
            Copilot 1CO by @guthleifur -
            <a
                href="https://t.me/+AXt5_EROQrVkZDE6"
                target="_blank"
                rel="noopener noreferrer"
                class="hover:underline"
                >нажать сюда</a
            >
            для репорта об ошибках и предложений по усовершенстованию
        </div>

        <script type="module">
            // Обработка ошибок загрузки модулей
            window.addEventListener('error', (event) => {
                console.error('Ошибка загрузки:', event);
                const filename = event.filename || event.target?.src || '';
                if (filename && (filename.includes('.js') || filename.includes('module'))) {
                    const appContent = document.getElementById('appContent');
                    if (appContent && appContent.classList.contains('hidden')) {
                        appContent.classList.remove('hidden');
                        console.error('Обнаружена ошибка загрузки модуля. Показываем контент.');
                    }
                }
            }, true);
            
            // Обработка необработанных промисов
            window.addEventListener('unhandledrejection', (event) => {
                console.error('Необработанная ошибка промиса:', event.reason);
                const appContent = document.getElementById('appContent');
                if (appContent && appContent.classList.contains('hidden')) {
                    appContent.classList.remove('hidden');
                }
            });
        </script>
        <script type="module" src="./script.js?v=20260205i"></script>
        <script type="module" src="./js/entry.js?v=20260205i"></script>
    </body>
</html>
